## 策略库使用说明

- **文件位置**：`strategy_library/strategy.md`
- **服务对象**：Stage 2 策略能力升级代理（通过 `stage2_capability_upgrade_agent/stage2_capability_upgrade_agent.py` 维护），以及 Stage 2 候选/遴选与执行阶段代理，用于在形成候选策略、遴选决策及执行阶段快速调用成熟策略；Stage 1 元分析代理仅访问能力库，无需修改策略库。
- **检索提示**：按分类（P–L）或编号（如 `P1`、`D2`）搜索，可在 IDE 中迅速跳转对应策略定义。

---

> **维护说明**：新增或修改策略必须通过 Stage 2 策略能力升级代理执行，此代理会对比 `strategy_library/strategy.md` 的快照并生成可直接粘贴的 Markdown 段落；Stage 1 不应直接编辑此文件。

### 策略索引总览

| 编号 | 名称 | 简短别名 | 典型适配场景 |
| --- | --- | --- | --- |
| P1 | `progressive_goal_refinement` | 目标分层 | 含糊目标澄清、需求拆解 |
| P2 | `milestone_backplanning` | 里程碑倒推 | 长周期项目排期、交付节奏设计 |
| I1 | `evidence_first_research` | 证据先行 | 事实查证、资料搜集 |
| I2 | `contextual_snapshot` | 背景快照 | 多文档信息同步、上下文对齐 |
| I3 | `evidence_snapshot_verification` | 证据快照验证 | 跨源事实核对、实时信息校验 |
| X1 | `exploratory_insight_cycle` | 探索迭代 | 研究探索、问题定义 |
| C1 | `collaborative_alignment_framework` | 协作对齐 | 跨团队协作、利益相关者管理 |
| F1 | `innovation_breakthrough_playbook` | 创新突破 | 创意发散、前瞻规划 |
| D1 | `tradeoff_matrix` | 利弊矩阵 | 方案评估、优先级选择 |
| D2 | `branch_and_bound_brainstorm` | 发散束收 | 创意生成、备选路径规划 |
| E1 | `fast_feedback_loop` | 快速反馈 | 原型验证、实验设计 |
| E2 | `auto_error_recovery` | 自动错误恢复 | 代码修复、智能重试 |
| E3 | `upstream_feedback_adjustment` | 上游反馈调整 | 阶段间信息回传、动态修正 |
| L1 | `lessons_learned_log` | 经验沉淀 | 项目复盘、持续改进 |

---

### P. 规划策略

#### `progressive_goal_refinement` (P1)
- **适配场景**：当任务目标模糊或存在多重约束时，需要澄清目标并拆分可执行子任务。
- **策略步骤**：
  1. 收集所有显性/隐性需求与约束，列成清单。
  2. 将宏观目标分解为“结果-指标-行动”三层结构。
  3. 对每一层的条目进行可验证性检查，并补充缺失信息。
- **典型示例**：用户提出“帮我上线一个 MVP”，先确认功能范围、验收指标，再分解至设计、开发、测试子任务。

#### `milestone_backplanning` (P2)
- **适配场景**：面对时间范围明确的项目，需要合理安排阶段交付物与缓冲。
- **策略步骤**：
  1. 明确最终交付成果与硬性截止日期。
  2. 从截止日期向前倒推关键里程碑，确保每个里程碑都有成果定义。
  3. 为高风险环节预留缓冲，并标注触发回滚/升级的条件。
- **典型示例**：规划三周迭代计划，从上线日倒推提测、联调、需求冻结日期，并设置每日 standup 检查点。

---

### I. 信息管理策略

#### `evidence_first_research` (I1)
- **适配场景**：需要快速聚合事实或第三方资料支撑观点的任务。
- **策略步骤**：
  1. 明确待验证的假设或问题列表，按照优先级排序。
  2. 对每一项先查找原始来源（官方数据、权威报告），再扩展到二次引用。
  3. 在记录结论时同步保留引用来源与可信度标记。
- **典型示例**：撰写市场分析时先搜集行业协会、政府公开数据，再补充媒体报道并标注来源可信度。

#### `contextual_snapshot` (I2)
- **适配场景**：跨多文档、多轮对话汇总信息，需保持上下文一致性。
- **策略步骤**：
  1. 对当前任务相关的文档、对话做一页摘要，包含关键事实与未决问题。
  2. 定义标准化字段（如时间、责任人、状态）以便快速对照。
  3. 每次上下文更新后立即刷新快照，防止信息漂移。
- **典型示例**：在多团队协作项目中，每周同步前将各方输入整合成统一状态快照，标注最新进展与阻塞项。

#### `evidence_snapshot_verification` (I3)
- **适配场景**：需要同时保障事实准确性与上下文一致性的跨源信息核对任务。
- **策略步骤**：
  1. 明确待验证事实，优先检索权威原始来源获取关键数据。
  2. 至少选择两个独立渠道交叉验证数据，并记录来源可信度与时间戳。
  3. 将各来源结果整理为结构化快照，保留差异点与验证状态。
  4. 对比不同来源的细节，分析矛盾项并给出逻辑一致的结论。
  5. 输出最终判定，并附上可追溯的引用与快照链接。
- **典型示例**：核查美国前总统配偶的出生日期时，分别检索美国国家档案馆与主流媒体数据库，将结果汇总为快照，标注来源及更新时间后完成对比结论。
- **注意事项**：若来源之间存在矛盾，需主动标记不一致原因并提示进一步验证路径；避免依赖单一或过期数据。

---

### X. 探索策略

#### `exploratory_insight_cycle` (X1)
- **适配场景**：针对陌生领域或复杂问题，需要先梳理知识边界再提出行动方案。
- **策略步骤**：
  1. 深度调研：广泛收集一手/二手信息，追踪关键术语与核心观点。
  2. 多源验证：对重要数据至少使用两个独立来源交叉验证。
  3. 模式识别：从汇总数据中提炼显性趋势与隐含规律。
  4. 假设验证：基于模式提出可检验假设，并设计验证步骤或小实验。
  5. 知识整合：将验证结果沉淀为结构化笔记/图谱，形成系统性理解。
- **典型示例**：在评估新兴技术可行性时，先调研行业报告与学术论文，验证不同来源的数据，识别应用趋势，设计概念验证实验，并将成果整理成决策备忘录。

---

### C. 协作策略

#### `collaborative_alignment_framework` (C1)
- **适配场景**：多方参与的项目需要统一目标、分工明确并管理潜在冲突。
- **策略步骤**：
  1. 利益相关者分析：识别关键决策者、影响者、执行者并记录其诉求与影响力。
  2. 沟通机制设计：建立定期会议、异步通道与升级路径，明确沟通节奏与输出模板。
  3. 共识建立：梳理各方核心关切点，寻找可接受的交集方案并形成书面确认。
  4. 分工协作：拆解任务并分配责任人、交付时间与依赖关系，确保透明可追踪。
  5. 冲突解决：预设常见冲突场景及缓解策略，指定调解人和升级流程。
- **典型示例**：在跨部门上线营销活动时，提前识别市场、产品、法务团队诉求，搭建同步/异步沟通机制，形成一致宣传口径，并设定冲突升级流程与备选方案。

---

### F. 创新策略

#### `innovation_breakthrough_playbook` (F1)
- **适配场景**：需要生成突破性解决方案、探索全新产品形态或规划前沿路线图。
- **策略步骤**：
  1. 打破常规：质疑现有流程与假设，列出默认前提并逐一挑战。
  2. 跨领域思考：借鉴其他行业或学科的成熟做法，寻找可迁移的类比。
  3. 逆向思维：从结果倒推或设计反向情境，发掘非常规路径。
  4. 组合创新：将不同概念、技术或方法进行重新组合，构造多种方案原型。
  5. 未来前瞻：评估新兴技术与趋势的潜力，绘制演进路线及前置条件。
- **典型示例**：在设计下一代教育产品时，质疑传统课程结构，引入游戏化与 AI 辅导的跨界灵感，构思反向课堂场景，组合多模块原型，并基于 XR、智能硬件趋势规划三年创新路线。

---

### D. 决策策略

#### `tradeoff_matrix` (D1)
- **适配场景**：需要比较多个方案的利弊并给出推荐结论。
- **策略步骤**：
  1. 确认决策标准（成本、风险、影响力等）并赋予权重。
  2. 为每个候选方案打分并注明依据，避免凭直觉判断。
  3. 输出综合评分，同时提示敏感项与潜在补救措施。
- **典型示例**：选择技术栈时，从维护成本、团队熟悉度、生态成熟度三个维度评估 Node.js 与 Python 方案。

#### `branch_and_bound_brainstorm` (D2)
- **适配场景**：需要发散思路但又要快速收敛形成行动计划。
- **策略步骤**：
  1. 先进行无约束的发散，列出所有可能路径并分类。
  2. 根据约束条件筛掉明显不可行选项，保留 3–5 个有潜力的分支。
  3. 对剩余分支设置验证实验或先行任务，快速验证并收敛。
- **典型示例**：为增长指标制定方案时，先收集渠道创意，再保留用户裂变、内容社区、合作推广三条路径进行小规模试点。

---

### E. 执行与验证策略

#### `fast_feedback_loop` (E1)
- **适配场景**：需要通过实验或原型快速验证假设，降低迭代成本。
- **策略步骤**：
  1. 将核心假设转化为可测量指标，设计最小可行实验。
  2. 定义反馈周期（如每日、每迭代）并设置数据采集与回顾机制。
  3. 根据反馈及时调整策略或终止无效路径。
- **典型示例**：上线新功能前推出灰度版本，收集用户点击率与留存数据，每日复盘并决定是否扩大覆盖。

#### `auto_error_recovery` (E2)
- **适配场景**：代码执行或系统运行中遇到可预期的错误，需要自动分析并尝试修复。
- **策略步骤**：
  1. 收集错误信息（异常类型、堆栈跟踪、输入参数、期望输出），进行结构化分析。
  2. 根据错误模式匹配常见修复策略：语法错误修正、逻辑错误调整、参数边界处理。
  3. 生成候选修复方案，按风险等级排序，依次尝试并验证结果。
  4. 若多次修复失败，记录失败原因并触发人工介入或上游阶段重新规划。
- **典型示例**：Python代码断言失败时，分析测试用例与算法逻辑，自动修正递推公式中的边界条件或索引范围。

#### `upstream_feedback_adjustment` (E3)
- **适配场景**：执行阶段发现的问题需要修正前置阶段的分析、策略或计划。
- **策略步骤**：
  1. 识别问题根源属于哪个前置阶段（Stage 1能力评估、Stage 2策略选择、Stage 3计划制定）。
  2. 将错误信息转化为结构化反馈，包含问题描述、影响范围、建议修正方向。
  3. 根据错误严重程度决定修正方式：实时更新表格字段、触发阶段重新执行、或标记风险待后续处理。
  4. 更新协作表单中的相关字段，确保后续任务能获取到修正后的信息。
- **典型示例**：代码执行发现算法选择错误时，自动更新Stage 1的复杂度评估，并建议Stage 2选择适合当前数据规模的策略。

---

### L. 学习与复盘策略

#### `lessons_learned_log` (L1)
- **适配场景**：项目结束或阶段节点后，需要沉淀经验并可复用。
- **策略步骤**：
  1. 按“背景-行动-结果-启示”结构记录关键事件与决策。
  2. 标注成功/失败的关键因素，并链接到对应数据或证据。
  3. 形成“可复用模板/注意事项”列表，供后续任务快速调用。
- **典型示例**：完成一次需求迭代后，总结哪些需求澄清方式最有效、哪些沟通路径延误进度，并在下个迭代中直接应用改进项。

---

> 维护说明：新增或修改策略时，请按照“编号 + 场景 + 步骤 + 示例”的结构补充内容，Stage1 Agent 会自动加载该策略库。




### X. 探索策略

#### `regio_math_verified_eas_sequence_checker` (X2)
- **适配场景**：Multi-step electrophilic aromatic substitution pathways that must rigidly follow a 1,3,5-regiochemistry pattern; any ortho/para deviation invalidates the route.
- **策略步骤**:
  1. Lock carbon indices once on the benzene ring; prohibit re-labeling mid-pathway.
  2. After each reaction, apply positional arithmetic to verify the new substituent lands meta to the existing pair; fail-fast on mismatch.
  3. On directing-group conflict (e.g., Br vs COR), trigger ≤2 Tavily queries for 2024-01+ authority; freeze if snapshot stale.
  4. Draw the intermediate structure and assert the 1,3,5-pattern visually; promote only if the sketch passes ≤1 s oracle.
  5. Export the first sequence that completes with all carbons in the required meta array.
- **典型示例**：Planning 1-(3-bromo-5-nitrophenyl)ethan-1-one: indices locked at step 0; each nitration or bromination is arithmetic-checked for meta placement; authority snapshot resolves acetyl vs bromo directing priority; final sketch confirms 1,3,5 substitution.
- **注意事项**：If any step yields ortho/para substitution or the authority snapshot is stale and human gate rejects, the entire sequence is discarded; no override allowed.


### E. 执行与验证策略

#### `evidence_driven_fast_feedback_verification` (E4)
- **适配场景**：需要验证正则表达式 `\s` 是否覆盖所有目标空白字符（含 NBSP、Unicode 15 罕见空白），且不允许盲目补丁。
- **策略步骤**：
  1. 权威快照：检索 Python 3.12 `re` 文档与 Unicode 15 规范，列出 `\s` 精确字符表并保存时间戳。
  2. 构建微语料：收集 ≥3 个"冷门"空白码位（如 `\u00A0`、`\u2003`、`\u202F`）及混合换行，生成文本测试集。
  3. 快速反馈循环：在 `code_interpreter` 内对空串、全空格、NBSP、`\r\n` 及微语料运行断言，记录 `repr()` 对比。
  4. 若失败，将新发现码位追加到语料并重新运行（最多 3 次迭代）；仍失败则停止并上报。
  5. 冻结最终测试集与快照，输出带引用链接的验证报告。
- **典型示例**：验证 `re.sub(r'\s+', '', text)` 时，发现 `\u202F` 未被覆盖，立即将其加入语料并重新跑断言，直至全部通过。
- **注意事项**：禁止自动扩展正则——任何未覆盖字符必须人工确认后再决定是否显式加入字符类。
```
